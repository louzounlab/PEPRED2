{% extends "layout.html" %}
{% block title %}PEPRED{% endblock %}
{% block head %}
    {{super()}}
    {% block style %}
        {{super()}}
    {% endblock %}
{% endblock %}
{% block body %}
    {{super()}}
<br>
<h1 style="text-align:center;font-size: 35px;color: #dark;font-weight: bold">PEPRED</h1>
<br>
<style>
    .help-tip{
    margin: auto;
    text-align: center;
    background-color: #809fff;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    font-size: 14px;
    line-height: 26px;
    cursor: default;
}

.help-tip:before{
    content:'?';
    font-weight: bold;
    color:#fff;
}

.help-tip:hover p{
    display:block;
    transform-origin: 100% 0%;
    -webkit-animation: fadeIn 0.3s ease-in-out;
    animation: fadeIn 0.3s ease-in-out;

}

.help-tip p{    /* The tooltip */
    display: none;
    text-align: left;
    background-color: #1E2021;
    padding: 20px;
    width: 300px;
    border-radius: 3px;
    box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.2);
    right: -4px;
    color: #FFF;
    font-size: 13px;
    line-height: 1.4;
    position:relative;

}

.help-tip p:before{ /* The pointer of the tooltip */
    content: '';
    width:0;
    height: 0;
    border:6px solid transparent;
    border-bottom-color:#1E2021;
    right:10px;
    top:-12px;
        position:relative;

}

.help-tip p:after{ /* Prevents the tooltip from being hidden */
    width:100%;
    height:40px;
    content:'';
    top:-40px;
    left:0;
        position:relative;

}

/* CSS animation */

@-webkit-keyframes fadeIn {
    0% {
        opacity:0;
        transform: scale(0.6);
    }

    100% {
        opacity:100%;
        transform: scale(1);
    }
}

@keyframes fadeIn {
    0% { opacity:0; }
    100% { opacity:100%; }
}
</style>
<form id="my-form" action="" method=post enctype=multipart/form-data autocomplete="off">

    <div class="row" >
        <div class="column" style="background: #6c757d;text-align: center; border-color: white; margin: auto; height: 80%; width: 70%;">
            <h2 style="color: white;font-size:25px"><b>Please insert your features</b></h2>
            <br>
            <div class="row" >
                <div class="column" style="background: #df0764;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                    <h4  for="model">Model: <br></h4>
                        <select name="model" id="model">
                              <option value="1">PE</option>
                              <option value="3">PE & preterm</option>
                        </select>
                    <div class="help-tip">
                        <p>The screening you want to perform: PE or PE with preterm. Default is PE.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="ga"> GA(days):   <br></h4>
                <input type="text" id="ga" name="ga", size="7" value="89">
                     <div class="help-tip">
                        <p>TGestational age where all following biomarker are taken (per days). Default is 89.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="pappa">Pappa: <br></h4>
                <input type="text" id="pappa" name="pappa", size="7" value="2.7"> <div class="help-tip">
                        <p>Pregnancy associated plasma protein-A. Default is 2.7.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="utpi">UTPI: <br></h4>
                <input type="text" id="utpi" name="utpi", size="7" value="1.65"> <div class="help-tip">
                        <p>Mean uterine. Default is 1.65.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="map">Map: <br></h4>
                <input type="text" id="map" name="map", size="7" value="86.5"> <div class="help-tip">
                        <p>Mean arterial pressure. Default is 86.5.</p>
                    </div><br><br>
                </div>               
            </div>
            <br>
            <div class="row" >
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="plgf">PLGF: <br></h4>
                <input type="text" id="plgf" name="plgf", size="7" value="35"> <div class="help-tip">
                        <p>Angiogenic placental growth factor. Default is 35.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%; height:110px">
                    <h4  for="plgf.machine">PLGF Machine<br></h4>
                        <select name="plgf.machine" id="plgf.machine" >
                              <option value="Delfia">Delfia</option>
                              <option value="Roche">East Roche</option>
                        </select>
                     <div class="help-tip">
                        <p>Type of machine used for plgf. Default is Delfia.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="interval">Interval(years): <br></h4>
                <input type="text" id="interval" name="interval", size="7" value="3"> <div class="help-tip">
                        <p>Interval to last pregnancy (per years). Default is 3.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="last.ga">Last GA(weeks):<br></h4>
                <input type="text" id="last.ga" name="last.ga", size="7" value="40"> <div class="help-tip">
                        <p>Gestational age of previous pregnancy (per weeks). Default is 40.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="age">Age(years): <br></h4>
                <input type="text" id="age" name="age", size="7" value="31"> <div class="help-tip">
                        <p>Mother age. Default is 31.</p>
                    </div><br><br>
                </div>
            <br>
            </div>
            <br>
            <div class="row" >
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="ht">HT(cm): <br></h4>
                <input type="text" id="ht" name="ht", size="7" value="164.9"> <div class="help-tip">
                        <p>Mother height in cm. Default is 164.9.</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                <h4 for="wt">WT(kg): <br></h4>
                <input type="text" id="wt" name="wt", size="7" value="67.1"> <div class="help-tip">
                        <p> Mother weigh. Default is 70.4</p>
                    </div><br><br>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%; height:110px">
                    <h4  for="race">Race<br></h4>
                        <select name="race" id="race" >
                              <option value="Black">Black</option>
                              <option value="East_Asian">East Asian</option>
                              <option value="Mixed">Mixed</option>
                              <option value="South_Asian">South Asian</option>
                              <option value="White" selected="selected">White</option>
                        </select>
                     <div class="help-tip">
                        <p>Mother race. Default is White.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                    <h4  for="conception">Conception<br></h4>
                        <select name="conception" id="conception">
                              <option value="IVF">IVF</option>
                              <option value="Ovulation_drugs">Ovulation drugs</option>
                              <option value="Spontaneous" selected="selected">Spontaneous</option>
                        </select>
                     <div class="help-tip">
                        <p>Conception type. Default is Spontaneous.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:110px">
                    <h4  for="smoking">Smoking<br></h4>
                        <select name="smoking" id="smoking">
                              <option value="No" selected="selected">No</option>
                              <option value="Yes">Yes</option>
                        </select>
                     <div class="help-tip">
                        <p> Whether the mother smokes. Default is No.</p>
                    </div>
                </div>

            </div>
            <br>
            <div class="row" >
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:130px">
                    <h4  for="FH_PE_grandmother" >FH PE Grandmother<br></h4>
                        <select name="FH_PE_grandmother" id="FH_PE_grandmother">
                              <option value="Yes">Yes</option>
                              <option value="No" selected="selected">No</option>
                        </select>
                     <div class="help-tip">
                        <p> Whether the grandmother of the baby had PE. Default is No.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:130px">
                    <h4  for="Chronic_hypertension">Chronic hypertension<br></h4>

                        <select name="Chronic_hypertension" id="Chronic_hypertension" >
                              <option value="Yes">Yes</option>
                              <option value="No" selected="selected">No</option>
                        </select>
                     <div class="help-tip">
                        <p>Whether the mother has Chronich hypertension. Default is No.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:130px">
                    <h4  for="Diabetes">Diabetes<br></h4>
                        <select name="Diabetes" id="Diabetes">
                              <option value="No">No</option>
                              <option value="Type_1_DM">Type1 DM</option>
                              <option value="Type_2_DM">Type2 DM</option>
                        </select>
                     <div class="help-tip">
                        <p>Whether the mother has diabetes (and type). Default is No.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:130px">
                    <h4  for="SLE">SLE<br></h4>
                        <select name="SLE" id="SLE">
                              <option value="No">No</option>
                              <option value="SLE_or_APS">SLE or APS</option>
                        </select>
                     <div class="help-tip">
                        <p>Whether the mother has Lupus. Default is No.</p>
                    </div>
                </div>
                <div class="column" style="background: #fb84b7;text-align: center; border-color: white; margin: auto; width: 17%;height:130px">
                    <h4  for="Previous_PE" >Previous PE<br></h4>
                        <select name="Previous_PE" id="Previous_PE">
                              <option value="Multip_PE">Multip PE</option>
                              <option value="Multip_no_PE">Multip no PE</option>
                              <option value="Nullip" selected="selected">Nullip</option>
                        </select>
                     <div class="help-tip">
                        <p>Whether the mother had previous PE. Default is No.</p>
                    </div>
                </div>
            </div>

            <hr style="background-color: #343333">
            <button type="submit" form="my-form" onclick="myFunction();" name="submit_file_btn" value="Results"
                                style="background-color: #7f0a2f;width:200px;border-radius: 7px;color: white;padding:
                                10px 15px;text-align: center; font-size: 25px;">
                            Results
            </button>
        </div>
    </div>
    <br>
    {% if error_message != "" %}
    <p style="color:darkred;text-align: center;font-size: 20px">
        <b>{{error_message}}</b></p>
    {% endif %}

    <p id="txt_mes"
       style="color: #40132a;text-align: center;font-size:20px;font-weight: 600;text-shadow: 4px 4px 8px white"></p>

    {% if results %}

    <h1  style="text-align: center;font-size:30px;font-weight: 600;text-shadow: 3px 3px 10px white">Your PE score is {{score}} which is in the {{precentege}}% Percentage</h1>
    <div class="row" style="background-color:red; margin: auto; text-align: center;border: 8px solid #000000; width:30%;">
        {% for i in range(100) %}
        <div class="color-box" style=" height:100px; width:1%;" id="color{{i}}"></div>
       {% endfor %}
    </div>

    <script  type = "text/javascript">
        window.addEventListener('load', (event) => {
            color(Math.round({{precentege}}))
        });
        function getColor(value){
            //value from 0 to 1
            var hue=((1-value)*120).toString(10);
            return ["hsl(",hue,",100%,50%)"].join("");
        }
        function color(score){
            for (let i = 0; i < 100; i++) {
            var c =  document.getElementById("color"+i.toString())
            if (i == Math.max(1,Math.min(Math.round(99/100*100),Math.round(score/100*100)))) {
                c.style.backgroundColor = "#000000"
            } else{
                c.style.backgroundColor = getColor(0.01*i)
                }
            }
        }
    </script>
    {% endif %}
    <script id="my_scr">
        function myFunction() {
            document.getElementById("txt_mes").innerHTML = "Analysis in process ...";
            var x = document.getElementById("link_output");
            x.style.display = "none";
        }
    </script>
    <br>

</form>

<p style="text-align: center; size: 20px"><b>Produced by: </b>Cirkin R, Ansbacher Z and Louzoun Y (2022).</p>
<hr style="background-color: #9e9e9e">
<p style="text-align:center; font-size:15px">&copy; Louzoun-Lab 2022</p>


{% endblock %}
